# ソフトウェア構成

ソフトウェア構成ですが、ざっくりと

- メニュー表示・ユーザー入力
- モード遷移
- OpenCVとのI/F

の３つのブロックで分けて、お互いの依存性は極力低くなるように注意します

## メニュー・ユーザー操作部(UI)

OpenCVを実験するのが目的なので、先ずはコンソール(CUI)で作ってしまいます。

将来的にはC#辺りでウインドウアプリ化も出来るように、他ブロックとの界面はそれなりに切っておきたいので、概ね以下のような入出力になれば将来的にも改造がし易いでしょうか。

- 他ブロックへ引き渡す( Output )データ
  - ファイル名は文字列( const char* )
  - 数値は整数型(int)もしくは浮動小数点型( float/double )
  - On/Offはブール定数( true/false )
- 他ブロックから引き渡されるデータ
  - 要求に対する、結果画像
  - 実行結果。エラーの場合はエラーにまつわる付加データ

## モード遷移

画像処理ソフトの最もシンプルな流れを考えるならば、以下のようになるでしょうか

- メニューを表示し、ユーザーからの入力を受け付ける
- 入力に応じて、適切なOpenCVの関数を呼び出して、結果を返す

しかし、

- 画像を少しずつ拡大・縮小したい
- 画像の色味を少しずつ変化させたい
- 入力操作に合わせて、順番に出力する画像を変えたい

といった機能を持たせようとするとモード遷移が必要になります。

とはいえ、先ずは個々の機能が単一アクションで動作する事が出来るようにしたいので、当面は最初に述べたシンプルな流れで機能を動かす事を目標にします。当面モード遷移部は仮実装状態にしておきましょう

## OpenCVとのI/F部

実際の処理はOpenCVが行うので、ここのブロックが画像処理のメインとなるでしょう。ただ、非常に悩ましいのですが、OpenCVには簡易的にですが絵を出力する機能までが備わっており、

- そういうのって、本当はUI部でやるんじゃないの？

という疑問が湧きます。…が、これもモード遷移の話と同様に、OpenCVを実験するのが主目的なので、

- 当面はOpenCVの画像出力機能をそのまま利用する
- OpenCVの画像出力On/Offが出来るような作りにしておく
- モード遷移が入った時は、UI部で描画が出来る仕組みを考える

と先送りで考えておきましょう。将来的には、MVCやらの概念に昇華出来るとカッコいいのかもしれません

# ファイル構成

上に述べた３つのブロックをディレクトリ単位で分けておきましょう。

取り敢えず以下のようなディレクトリ構成で進めてみて、適宜調整する事にします

- /ui…メニュー表示・ユーザー入力
  - /include
  - /src
- /mode…モード遷移
  - /include
  - /src
- /ocv…OpenCVとのI/F
  - include
  - src